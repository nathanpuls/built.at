<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sheet Links</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');

    html {
      font-size: 30px;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: #fff;
      color: #000;
      padding: 20px;
      margin: 0;
      font-weight: 200;
    }

    .content {
      display: flex;
      flex-wrap: wrap;
      margin: 0 auto;
      gap: 6px;
    }

    a {
      color: black;
      text-decoration: none;
      padding: 2px 6px;
      background: rgba(0, 150, 255, 0.07);
      border-radius: 4px;
      display: inline-flex;
      align-items: center;
      transition: background 0.2s ease;
    }

    a:focus, a:active {
      outline: none;
      background: rgba(0, 150, 255, 0.07);
    }

    a:visited {
      color: inherit;
      background: rgba(0, 150, 255, 0.07);
    }

    @media (max-width: 600px) {
      html {
        font-size: 24px;
      }
    }
  </style>
</head>
<body>
  <div class="content" id="main"></div>

  <script>
    // Get 'sheet' URL parameter from the query string, or use the default if not provided
    const urlParams = new URLSearchParams(window.location.search);
    const sheetURL = urlParams.get('sheet') || "https://docs.google.com/spreadsheets/d/e/2PACX-1vQRRT31nhYVVu1nZ1eYndxWfLzp_E2KjtL7qonp2OtGJxi69RQHecRG6B8K4QnJL0fx2gFyXsnv1Q5M/pub?output=csv";

    // Define the color map, with "Gray" now being a lighter gray (#f0f0f0)
    const colorMap = {
      "Red":    { bg: "#ffe5e5", text: "#000" },
      "Orange": { bg: "#ffeacc", text: "#000" },
      "Yellow": { bg: "#fff9cc", text: "#000" },
      "Green":  { bg: "#e6ffe6", text: "#000" },
      "Blue":   { bg: "#e6f7ff", text: "#000" },
      "Indigo": { bg: "#e6e6ff", text: "#000" },
      "Violet": { bg: "#f5e6ff", text: "#000" },
      "White":  { bg: "#ffffff", text: "#000" },
      "Black":  { bg: "#000000", text: "#fff" },
      "Gray":   { bg: "#f0f0f0", text: "#000" }  // Lighter gray background with black text
    };

    fetch(sheetURL)
      .then(response => response.text())
      .then(csv => {
        const rows = csv.trim().split('\n').map(r => r.split(','));
        const headers = rows[0].map(h => h.trim().toLowerCase());
        const linkLabelIndex = headers.indexOf("link label");
        const linkUrlIndex = headers.indexOf("link url");
        const colorIndex = headers.indexOf("color");
        const container = document.getElementById('main');

        rows.slice(1).forEach(row => {
          const label = row[linkLabelIndex]?.trim();
          let url = row[linkUrlIndex]?.trim();
          const colorName = row[colorIndex]?.trim(); // Color from the sheet (e.g., Gray, Black, etc.)

          // Skip rows where either the label or the URL is missing
          if (!label || !url) return;

          // Default to Google search if no URL is provided
          if (!url) {
            url = `https://www.google.com/search?q=${encodeURIComponent(label)}`;
          } else if (!/^https?:\/\//i.test(url) && !/^mailto:|^tel:/i.test(url)) {
            url = `https://${url}`;  // Ensure valid URL format
          }

          const colorStyle = colorMap[colorName] || colorMap["Blue"]; // Default to Blue if no color is specified
          
          // Apply color from the color map to the label
          const a = document.createElement('a');
          a.href = url;
          a.target = "_blank";
          a.textContent = label || url;
          a.style.backgroundColor = colorStyle.bg;
          a.style.color = colorStyle.text;
          container.appendChild(a);
        });
      })
      .catch(err => console.error("Error loading CSV data:", err));
  </script>
</body>
</html>
